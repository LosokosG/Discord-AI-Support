---
import DashboardLayout from "../../layouts/DashboardLayout.astro";
import ServerSelector from "../../components/dashboard/ServerSelector";
import { createSupabaseServerInstance } from "../../db/supabase.server";

// SprawdÅº, czy uÅ¼ytkownik jest zalogowany
const { cookies, redirect } = Astro;

const supabase = createSupabaseServerInstance({
  cookies,
  headers: Astro.request.headers,
});

const {
  data: { user },
} = await supabase.auth.getUser();

if (!user) {
  return redirect("/auth/login");
}

console.log("ğŸ“¢ [dashboard/index] SzczegÃ³Å‚y uÅ¼ytkownika:", {
  email: user.email,
  id: user.id,
  metadata: user.user_metadata,
});
---

<DashboardLayout title="Panel zarzÄ…dzania | Discord AI Support Bot">
  <div class="container mx-auto p-6">
    <ServerSelector client:load />
  </div>
</DashboardLayout>
